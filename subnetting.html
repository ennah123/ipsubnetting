<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
   <div class="min-h-screen bg-gray-50 flex items-center justify-center p-6 font-mono text-slate-800">
    <div class="w-full max-w-2xl bg-white border border-emerald-200 rounded-lg shadow-[0_10px_40px_rgba(0,0,0,0.04)] overflow-hidden">
        

        <div class="p-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="md:col-span-2">
                    <label class="block text-[10px] uppercase mb-2 text-emerald-600 font-bold tracking-widest">IP_ADDRESS</label>
                    <input type="text" id="ip" value="172.31.200.15" 
                        class="w-full bg-gray-50 border border-gray-200 rounded p-3 text-lg text-slate-700 focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 outline-none transition-all placeholder:text-gray-300" 
                        placeholder="0.0.0.0">
                </div>
                <div>
                    <label class="block text-[10px] uppercase mb-2 text-emerald-600 font-bold tracking-widest">MASK</label>
                    <div class="flex items-center bg-gray-50 border border-gray-200 rounded px-3">
                        <span class="text-emerald-600 font-bold">/</span>
                        <input type="number" id="mask" value="21" 
                            class="w-full bg-transparent border-none p-3 text-lg text-slate-700 focus:ring-0 outline-none">
                    </div>
                </div>
            </div>

            <button onclick="subnet()" 
                class="group relative w-full overflow-hidden bg-emerald-600 border border-emerald-700 py-4 rounded font-bold uppercase tracking-widest text-white transition-all duration-300 active:scale-[0.98] shadow-md hover:shadow-emerald-200">
                <span class="relative z-10">CALCULATE</span>
                <div class="absolute inset-0 bg-emerald-500 scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-300"></div>
            </button>

            <div id="display" class="mt-4 text-center text-red-500 text-xs italic min-h-[1.25rem]"></div>

            <div class="mt-8 relative">
                <div class="absolute -top-3 left-4 bg-white px-2 text-[10px] text-emerald-600 font-bold uppercase tracking-tighter">RESUALT</div>
                <div class="bg-gray-50/50 border border-gray-100 p-4 rounded-md">
                    <table id="res" class="w-full">
                        
                    </table>
                </div>
            </div>
        </div>

    </div>
</div>
</body>
<script>
    function subnet() {
        const mask = Number(document.getElementById('mask').value)
        const ip = document.getElementById('ip').value

        if (mask < 1 || mask > 32) return 

        if (mask === 32) {
            display.innerText = "resaultNetwork: " + ip + "\nresaultBroadcast: " + ip + "\nfirstAddress: "+ "no" + "\nlastAddress: "+ "no"
        }
        else{ 
        const display = document.getElementById('display')
        const part = mask >= 1 && mask < 8? 0: mask >= 8 && mask < 16? 1: mask >= 16 && mask < 24? 2: 3

        const splitedIP = ip.split(".")
        const splitedPartBinary = Number(splitedIP[part]).toString(2).padStart(8, '0')

        let mask2 = mask >= 8 ? mask - 8 : mask

        while (mask2 >= 8) {
           mask2 -= 8 
        }

        const network = splitedPartBinary.slice(0, mask2) + '0'.repeat(splitedPartBinary.length - mask2)
        const broadcast = splitedPartBinary.slice(0, mask2) + '1'.repeat(splitedPartBinary.length - mask2)

        let resaultNetwork = ""
        let resaultBroadcast = ""
        let firstAddress = ""
        let lastAddress = ""

        switch (part) {
            case 0:
                resaultNetwork = `${parseInt(network, 2)}.0.0.0`
                firstAddress = `${parseInt(network, 2)}.0.0.1`
                lastAddress = `${parseInt(broadcast, 2)}.255.255.254`
                resaultBroadcast = `${parseInt(broadcast, 2)}.255.255.255`
                break;
            
            case 1:
                resaultNetwork = `${splitedIP[0]}.${parseInt(network, 2)}.0.0`
                firstAddress = `${splitedIP[0]}.${parseInt(network, 2)}.0.1`
                lastAddress = `${splitedIP[0]}.${parseInt(broadcast, 2)}.255.254`
                resaultBroadcast = `${splitedIP[0]}.${parseInt(broadcast, 2)}.255.255`
                break;
            
            case 2:
                resaultNetwork = `${splitedIP[0]}.${splitedIP[1]}.${parseInt(network, 2)}.0`
                firstAddress = `${splitedIP[0]}.${splitedIP[1]}.${parseInt(network, 2)}.1`
                lastAddress = `${splitedIP[0]}.${splitedIP[1]}.${parseInt(broadcast, 2)}.254`
                resaultBroadcast = `${splitedIP[0]}.${splitedIP[1]}.${parseInt(broadcast, 2)}.255`
                break;
            
            case 3:
                resaultNetwork = `${splitedIP[0]}.${splitedIP[1]}.${splitedIP[2]}.${parseInt(network, 2)}`
                firstAddress = mask === 31 ? "no" : `${splitedIP[0]}.${splitedIP[1]}.${splitedIP[2]}.${parseInt(network, 2)+1}`
                lastAddress = mask === 31 ? "no" : `${splitedIP[0]}.${splitedIP[1]}.${splitedIP[2]}.${parseInt(broadcast, 2)-1}`
                resaultBroadcast = `${splitedIP[0]}.${splitedIP[1]}.${splitedIP[2]}.${parseInt(broadcast, 2)}`
                break;
            
            default:
                break;
        }

        // display.innerText = parseInt(network, 2) + " \n" + parseInt(broadcast, 2) + "  \n mask2: " + mask2 + "\n part: " + (part + 1)
        // display.innerHTML += "<br><br>"


        const table = document.getElementById('res')
        table.innerHTML = `
           <tr><th class='text-start'>IP Adresse</th> <td>${ip}</td></tr>
           <tr><th class='text-start'>Network Adresse</th> <td>${resaultNetwork}</td></tr>
           <tr><th class='text-start'>Broadcast Adresse</th> <td>${resaultBroadcast}</td></tr>
           <tr><th class='text-start'>First usable Adresse</th> <td>${firstAddress}</td></tr>
           <tr><th class='text-start'>Last usable Adresse</th> <td>${lastAddress}</td></tr>
        `

        // display.innerText = "resaultNetwork: " + resaultNetwork + "\nresaultBroadcast: " + resaultBroadcast + "\nfirstAddress: "+ firstAddress + "\nlastAddress: "+ lastAddress
        }
    }
</script>
</html>